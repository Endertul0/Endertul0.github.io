<!DOCTYPE html>
<html>

<head>
	<title>Login to Endertul0.github.io</title>
	<link rel="icon" type="image/x-icon" href="favicon.ico">
	<meta name="hibp-verify" content="dweb_5ry8igsvy27ttdcdacbljkdk" />
	<style>
		#incorrect {
			color: white;
		}

		#unm {
			border: 3px ridge gold;
		}

		#psw {
			border: 3px ridge gold;
		}

		#loginbutton {
			border: 3px ridge gold;
		}
	</style>
	<script>
	</script>
	<script type="text/javascript" type="module" id="login">
		const users = new Map(String, String);
		users.set("endertul", "")

		function isValid(isPass, val) {
			if (!isPass) {
				return document.getElementById('inputUser').value == val;
			}
			return document.getElementById('inputPassword').value == val;
		}

		function incorrect() {
			document.getElementById('incorrect').style.color = 'red';
		}

		function login() {
			users.forEach(user => {
				if (isValid(false, user)) {
					if (isValid(true, users[user])) {
						document.cookie = "currentUser=" + user + "; SameSite=Lax";
						document.cookie = "passIn=" + users[user] + "; SameSite=Lax";
						console.log('User ', document.getElementById('inputUser').value, ' logged in.');

						window.location.replace('homepage/index.html');
						return;
					}
					incorrect()
					return;
				}
				incorrect()
			});
		}

		

		function checkCookies() {
			if (!document.cookie.split("; ")
				.find((row) => row.startsWith("currentUser"))
			) {
				var userNm = row;
				userNm.replace("currentUser=", "");
				document.getElementById("inputUser").innerText = userNm
				if (!document.cookie.split("; ")
					.find((row2) => row2.startsWith("passIn"))
				) {
					var passStr = row2;
					passStr.replace("passIn=", "");
					document.getElementById("inputPassword").innerText = passStr
					login()
				}
				login()
			}
		}
	</script>
</head>

<body onload="checkCookies();">
	<div id="unm">
		<label for="inputUser">Username:</label><br>
		<input type="text" id="inputUser" name="inputUser"><br>
	</div>
	<div id="psw">
		<label for="inputPassword">Password:</label><br>
		<input type="password" id="inputPassword" name="inputPassword">
	</div>
	<div>
		<button id="loginbutton" onClick="login();">Login</button>
	</div>
	<p id="incorrect">Unrecognized username / password</p>
</body>

</html>